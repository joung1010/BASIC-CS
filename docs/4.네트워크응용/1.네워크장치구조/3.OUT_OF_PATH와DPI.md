## Out of Path의 센서 개념

**Out of Path의 다른 말은 센서**이다. **센서라는 말이 어떠한 것을 감지할 것인가가 관건이고 보통은 따라오는 말로 패킷 수집 장치**이다. **수집 장치는 크게 두 가지가 있는데 하나는 L2 수준의 포트(랜선 꽂는 단자) 미러링**이 있다.

**네트워크 인터페이스 포트로 여러 가지 데이터가 왔다 갔다 하는 스위치가 스위칭하는 모든 L2 프레임 데이터를 특정 포트로 카피해달라는 것**이다.

```
`─────────────────────────
│ A │ B  │ C │ 미러링 포트 │
─────────────────────────
                    │
                    │───── 센서`

`포트 미러링 상세 구조:

일반 스위치 동작:
┌─────────────────────────────────────────────────┐
│ Port A ↔ Port B: 직접 통신                      │
│ Port C: 트래픽 없음 (미사용)                     │
│                                                 │
│ A ──→ B: 프레임이 A에서 B로만 전달              │
│ C 포트에는 데이터 없음                          │
└─────────────────────────────────────────────────┘

미러링 설정 후:
┌─────────────────────────────────────────────────┐
│ Port A ↔ Port B: 원본 통신 유지                 │
│ Mirror Port: 모든 트래픽 복사본 수신             │
│                                                 │
│ 원본: A ──→ B                                   │
│ 복사: A ──→ Mirror Port (센서로 전달)           │
│       B ──→ Mirror Port (센서로 전달)           │
└─────────────────────────────────────────────────┘

미러링 포트 특성:
┌─────────────────────────────────────────────────┐
│ • 단방향 전송 (송신 전용)                       │
│ • 원본 트래픽에 영향 없음                       │
│ • 모든 프레임 복사 (브로드캐스트, 유니캐스트)    │
│ • 오버헤드: 스위치 성능에 따라 5-10%            │
└─────────────────────────────────────────────────┘`
```

**이때 A랑 B랑만 통신한다고 하면 C쪽은 데이터가 전달이 되지 않는다. 그러면 이제 해당 장치에 통신하는 프레임을 복사해서 센서에게 전달한다. 이때 복사라 하지 않고 미러링이라는 용어를 사용하는데 마치 거울에 비친 모습처럼 원본의 데이터를 복사한다는 의미를 강조하기 위해서 미러링이라 하는 것이다. 이 미러링 자체가 많은 처리가 필요하다 보니 보통 하드웨어적 장치의 성능이 좋아야만 한다**.

## TAP 스위치

**이 미러링 말고 전문 수집 장치인 TAP 스위치가 있다. TAP 스위치는 그냥 복사 전문 장치라고 생각하면 된다**.

**이 TAP 스위치는 단자로 통하는 인바운드 아웃바운드되는 프레임 데이터를 연결된 단자 모두에게 복사해준다. 한 곳에서만 미러링이 발생해도 많은 부하를 주는데 이것을 연결된 모든 단자에게 미러링이 진행되다 보니 매우 좋은 성능을 가지고 있다**.

```
TAP 스위치 구조:

물리적 TAP:
┌─────────────────────────────────────────────────┐
│ 송신자 ──→ [TAP] ──→ 수신자                     │
│              │                                  │
│              ├──→ 분석 장비 1                   │
│              ├──→ 분석 장비 2                   │
│              └──→ 분석 장비 3                   │
│                                                 │
│ 특징:                                           │
│ • 네트워크 경로에 투명하게 삽입                  │
│ • 지연 시간 최소 (나노초 단위)                   │
│ • 100% 트래픽 복사                             │
│ • 네트워크 장애 시 자동 우회 (Fail-safe)        │
└─────────────────────────────────────────────────┘

TAP vs 미러링 포트 비교:
┌─────────────────────────────────────────────────┐
│ TAP 장점:                                       │
│ • 전용 하드웨어로 고성능                        │
│ • 네트워크 영향 최소                            │
│ • 패킷 손실 없음                                │
│ • 타임스탬프 정확도 높음                        │
│                                                 │
│ 미러링 포트 장점:                               │
│ • 별도 장비 불필요                              │
│ • 설정으로 쉽게 활성화                          │
│ • 비용 효율적                                   │
│ • 원격 관리 가능                                │
└─────────────────────────────────────────────────┘

TAP 배치 전략:
┌─────────────────────────────────────────────────┐
│ 네트워크 경계점:                                │
│ • 인터넷 연결점                                 │
│ • DMZ 구간                                     │
│ • 데이터센터 입구                               │
│ • 중요 서버 앞단                                │
│                                                 │
│ 내부 네트워크:                                  │
│ • 백본 네트워크                                 │
│ • 서버 팜 연결점                                │
│ • VLAN 간 연결점                               │
└─────────────────────────────────────────────────┘
```

## 패킷 캡처와 분석

**Wireshark 같은 프로그램을 이용하면 개인 PC에서도 이러한 것들을 할 수 있다. 그래서 센서가 분석과 같은 뭔가를 해야 한다면 수집을 해야 되는데 좋은 말로 해서 수집이지 나쁜 쪽으로 사용하게 되면 도청이 된다**.

```
패킷 캡처 도구:

개인용 도구:
┌─────────────────────────────────────────────────┐
│ Wireshark:                                      │
│ • GUI 기반 패킷 분석                            │
│ • 500+ 프로토콜 지원                           │
│ • 필터링 및 통계 기능                           │
│                                                 │
│ tcpdump:                                        │
│ • 명령줄 기반                                   │
│ • 경량화된 캡처                                 │
│ • 스크립트 자동화 가능                          │
│                                                 │
│ tshark:                                         │
│ • Wireshark의 CLI 버전                         │
│ • 배치 처리 최적화                              │
└─────────────────────────────────────────────────┘

엔터프라이즈급 도구:
┌─────────────────────────────────────────────────┐
│ NIDS (Network Intrusion Detection System):     │
│ • Snort, Suricata                              │
│ • 실시간 위협 탐지                              │
│ • 룰 기반 분석                                  │
│                                                 │
│ NPM (Network Performance Monitoring):          │
│ • SolarWinds, PRTG                            │
│ • 성능 지표 수집                                │
│ • 트래픽 패턴 분석                              │
│                                                 │
│ 포렌식 도구:                                    │
│ • EnCase, X-Ways                               │
│ • 법적 증거 수집                                │
│ • 체인 오브 커스터디                            │
└─────────────────────────────────────────────────┘
```

## 인터넷 검열 메커니즘

```
       192.168.0.100   192.168.0.1
         PC ────────── Gateway ──────────────ISP
                                            │
                                            │           ────────── Server www.abc.com
                                            │          │
                                            └─────────ISP
```

**우리가 어떤 특정 사이트 [www.abc.com에](http://www.abc.xn--com-568n/) 접속하려 한다. 근데 해당 사이트가 특정한 저작권 위반 사이트로 가정했을 때** 우리가 **해당 사이트에 접속했을 때 어떻게 화면에 abc 페이지 화면이 아닌 워닝 페이지가 나오게 되는 것일까?**

**이는 우리가 접속을 하기 위해서 패킷을 생성하고 보내는데 중간에 ISP 수준에서 이걸 모니터링하고 있다. 그래서 들어오는 데이터들을 모니터링해서 유해 사이트일 때 해당 사이트에 접속하지 못하게 Drop시켜버리는 것이다. 어? 근데 이런 건 Inline 장비만 가능한 것 아닌가요? 맞다!**

그래서 **이런 통신 HTTP 통신을 하는데 이때 수신쪽 서버 정보를 ISP쪽에서 일정 구간에서 전부 수집, TAP핑해서 확인한 다음에 해당 접속 사이트가 유해사이트인 경우 ISP 서버가 중간에 실제 abc.com이 접속한 것처럼 응답을 해버린다**.

**물론 실제 abc.com쪽에서도 응답을 하지만 이 서버보다 더 빠르게 응답할 수 있다면 ISP쪽에서 보낸 응답 페이지가 먼저 보이게 되는 것이다**.

```
인터넷 검열 동작 과정:

1단계: 정상 요청
┌─────────────────────────────────────────────────┐
│ 사용자 PC ──→ DNS 조회: abc.com IP 주소?        │
│ DNS 서버 ──→ 응답: 1.2.3.4                     │
│ 사용자 PC ──→ HTTP GET / 요청 (1.2.3.4로)      │
└─────────────────────────────────────────────────┘

2단계: ISP 모니터링
┌─────────────────────────────────────────────────┐
│ ISP 라우터에서 패킷 미러링                       │
│ ┌─────────────────────────────────────────────┐ │
│ │ HTTP 요청 분석:                             │ │
│ │ Host: abc.com                               │ │
│ │ User-Agent: Mozilla/5.0...                  │ │
│ │ GET / HTTP/1.1                              │ │
│ └─────────────────────────────────────────────┘ │
│                                                 │
│ 유해 사이트 DB 조회: abc.com → 차단 대상!       │
└─────────────────────────────────────────────────┘

3단계: 차단 응답
┌─────────────────────────────────────────────────┐
│ ISP에서 빠른 응답 생성:                         │
│ HTTP/1.1 200 OK                                │
│ Content-Type: text/html                         │
│                                                 │
│ <html>                                          │
│ <body>                                          │
│ <h1>접속이 차단된 사이트입니다</h1>              │
│ <p>저작권 보호를 위해 차단되었습니다</p>          │
│ </body>                                         │
│ </html>                                         │
└─────────────────────────────────────────────────┘

4단계: 경쟁 응답
┌─────────────────────────────────────────────────┐
│ ISP 응답 (빠름): 차단 페이지                     │
│ 실제 서버 응답 (느림): 원본 페이지               │
│                                                 │
│ 브라우저는 먼저 도착한 ISP 응답을 표시           │
│ (실제 서버 응답은 무시됨)                       │
└─────────────────────────────────────────────────┘

기술적 구현 방법:
┌─────────────────────────────────────────────────┐
│ DPI 기반 분석:                                  │
│ • HTTP Host 헤더 검사                          │
│ • SNI (Server Name Indication) 분석           │
│ • URL 패턴 매칭                                │
│                                                 │
│ DNS 차단:                                       │
│ • 가짜 DNS 응답                                │
│ • DNS 싱크홀                                   │
│ • DNS 리다이렉트                               │
│                                                 │
│ IP 차단:                                        │
│ • 라우팅 블랙홀                                 │
│ • 패킷 드롭                                     │
│ • TCP 리셋 주입                                │
└─────────────────────────────────────────────────┘
```

## DPI와 SPI 개념

**여기서 정리하자면 L7 HTTP는 소켓 스트림 수준에서의 데이터를 처리한다. 그리고 이 스트림 데이터를 세그멘테이션을 해서 MSS 크기에 맞게 데이터를 쪼개서 세그먼트로 만들고 그 세그먼트가 패킷에 담겨서 통신하게 된다**.

```
패킷 헤더
─────────────────────────────
│ IP 헤더 │ TCP 헤더 │ HTTP 헤더 │
─────────────────────────────
<   HEADER    >
                < Payload >
```

그래서 **이 패킷을 뜯어서 보면 IP Header, TCP Header, HTTP Header 이렇게 정보를 확인할 수 있다. 이때 TCP/IP 수준에서 HTTP 헤더는 페이로드의 일부이다. 근데 이때 이 Payload를 들여다보는 행위를 DPI라고 부른다. 그리고 HTTP는 어쨌든 프로토콜의 헤더 정보이고 이것을 확인하는 행위를 SPI(Shallow Packet Inspection)라고 한다**.

```
패킷 검사 기법:

SPI (Shallow Packet Inspection):
┌─────────────────────────────────────────────────┐
│ 검사 대상:                                      │
│ • IP 헤더: 출발지/목적지 IP                     │
│ • TCP/UDP 헤더: 포트 번호                      │
│ • 기본적인 프로토콜 정보                        │
│                                                 │
│ 특징:                                           │
│ • 빠른 처리 속도                                │
│ • 하드웨어 가속 가능                            │
│ • 기본적인 방화벽 기능                          │
│ • 낮은 CPU 사용률                              │
└─────────────────────────────────────────────────┘

DPI (Deep Packet Inspection):
┌─────────────────────────────────────────────────┐
│ 검사 대상:                                      │
│ • 애플리케이션 데이터                           │
│ • HTTP URL, 헤더                               │
│ • 이메일 내용                                   │
│ • 파일 전송 내용                                │
│ • 프로토콜별 상세 정보                          │
│                                                 │
│ 특징:                                           │
│ • 상세한 내용 분석                              │
│ • 높은 CPU/메모리 사용                         │
│ • 실시간 처리 어려움                            │
│ • 정교한 정책 적용 가능                         │
└─────────────────────────────────────────────────┘

검사 깊이 비교:
┌─────────────────────────────────────────────────┐
│ 계층별 정보 접근:                               │
│                                                 │
│ L2: MAC 주소                                   │
│ L3: IP 주소, 프로토콜 타입                      │
│ L4: 포트 번호, 연결 상태                        │
│ L5-L7: 애플리케이션 데이터, 콘텐츠               │
│                                                 │
│ SPI: L2-L4 정보만 검사                         │
│ DPI: L5-L7 정보까지 검사                       │
└─────────────────────────────────────────────────┘

DPI 활용 사례:
┌─────────────────────────────────────────────────┐
│ 보안 분야:                                      │
│ • 멀웨어 탐지                                   │
│ • 데이터 유출 방지 (DLP)                       │
│ • 애플리케이션 제어                             │
│                                                 │
│ 네트워크 관리:                                  │
│ • 대역폭 관리                                   │
│ • QoS 정책 적용                                │
│ • 트래픽 분류                                   │
│                                                 │
│ 컴플라이언스:                                   │
│ • 규정 준수 모니터링                            │
│ • 감사 로그 생성                                │
│ • 포렌식 증거 수집                              │
└─────────────────────────────────────────────────┘
```

## 망 중립성과 법적 이슈

그래서 **이러한 SPI가 정보통신 보호법에 위반되는 것은 아닐까? 내가 통신에 대한 비밀을 보장받을 권리가 있는데 그래서 우리나라에서 이러한 부분 때문에 논란이 되곤 한다. 어떤 건 통과시키고 말고 하는 것에 대해서다**.

그래서 **ISP들은 특정 누군가는 통과시켜주고 누군가는 통과시켜주지 못하게 하지 못한다. 중립적으로 법으로 지정된 유해사이트를 제외하고는 공평하게 이를 처리해야 한다. 이것이 망 중립성의 원칙**이다.

```
망 중립성과 검열의 딜레마:

망 중립성 원칙:
┌─────────────────────────────────────────────────┐
│ 모든 인터넷 트래픽을 동등하게 처리               │
│                                                 │
│ 금지 사항:                                      │
│ • 특정 사이트 속도 제한                         │
│ • 유료 우선 처리 (Fast Lane)                   │
│ • 경쟁사 서비스 차단                            │
│ • 정치적 검열                                   │
│                                                 │
│ 예외 사항:                                      │
│ • 법정 유해사이트 차단                          │
│ • 저작권 침해 사이트                            │
│ • 아동 보호 관련                                │
│ • 국가 보안 관련                                │
└─────────────────────────────────────────────────┘

기술과 법의 충돌:
┌─────────────────────────────────────────────────┐
│ 기술적 가능성:                                  │
│ • DPI로 모든 통신 내용 분석 가능                │
│ • 실시간 트래픽 제어 가능                       │
│ • 개인별 맞춤 차단 가능                         │
│                                                 │
│ 법적 제약:                                      │
│ • 통신의 비밀 보장                              │
│ • 표현의 자유                                   │
│ • 사생활 보호                                   │
│ • 과잉 규제 금지                                │
└─────────────────────────────────────────────────┘

국가별 접근 방식:
┌─────────────────────────────────────────────────┐
│ 미국: 강한 망 중립성, 제한적 검열               │
│ 유럽: GDPR 기반 개인정보 보호 중심              │
│ 중국: 강력한 국가 통제 (Great Firewall)        │
│ 한국: 선별적 차단, 법원 명령 기반               │
└─────────────────────────────────────────────────┘
```

## Out of Path 처리 아키텍처

```
              Process                      Process
                                             │   수집 + 분석
User Mode                                    │                          
─────────────────────────────────────────────────────────────
Kernel Mode    ┌───────────────────────       │
               │                TCP   │       │             
               └──────────────────────        │
               ┌─────────────────────────     │
               │                IP      │     │             
               └─────────────────────────     │
                                              │
               ┌────────────────────────────────────────┐             
               │            Filter(Sensor)    │         │             
               └────────────────────────────────────────┘
                                              │
S/W            Driver  ────────────────────────                                              
─────────────────────────────────────────────────────────────
H/W            NIC                                   
                │
 프레임           │
카피데이터  ───────
```

그래서 **Out of Path는 데이터를 끌어올려서 프로세스에게 전달하고 그런 것이 아니라 바로 데이터를 읽어서 수집하고 그것을 분석한다**.

## 실시간 분석의 기술적 도전

그러면 **이때 의문점이 수집한 데이터를 어딘가 저장해야지 분석이 가능하지 않을까?? 실제 어떤 물리적인 HDD 같은 데에 쓰고 이를 나중에 읽어서 분석해야 할 것인데 실제 네트워크 속도가 이 데이터를 하드디스크에 쓰는 속도보다 빠르다. 그래서 이 일련의 과정을 빠르게 처리하는 것이 핵심 기술**이다.

```
실시간 패킷 분석의 기술적 과제:

속도 비교:
┌─────────────────────────────────────────────────┐
│ 네트워크 속도:                                  │
│ • 1Gbps = 125MB/s                              │
│ • 10Gbps = 1.25GB/s                           │
│ • 100Gbps = 12.5GB/s                          │
│                                                 │
│ 저장 장치 속도:                                 │
│ • HDD: 100-200MB/s (순차 쓰기)                 │
│ • SSD: 500-3500MB/s                           │
│ • NVMe: 3000-7000MB/s                         │
│ • RAM: 20-50GB/s                              │
│                                                 │
│ 결론: 고속 네트워크 > 저장 장치 속도            │
└─────────────────────────────────────────────────┘

해결 기법:

1. 선별적 저장:
┌─────────────────────────────────────────────────┐
│ • 메타데이터만 저장 (헤더 정보)                 │
│ • 알려진 패턴만 저장                            │
│ • 이상 트래픽만 저장                            │
│ • 샘플링 기반 저장 (1% 또는 10%)               │
└─────────────────────────────────────────────────┘

2. 실시간 분석:
┌─────────────────────────────────────────────────┐
│ • 스트리밍 분석 (저장 없이 즉시 처리)           │
│ • 인메모리 분석 (RAM 기반)                      │
│ • 하드웨어 가속 (FPGA, GPU)                    │
│ • 분산 처리 (여러 서버로 부하 분산)             │
└─────────────────────────────────────────────────┘

3. 계층적 저장:
┌─────────────────────────────────────────────────┐
│ 단계별 데이터 보관:                             │
│ • 실시간: 메모리 (최근 수 분)                   │
│ • 단기: SSD (최근 수 시간)                     │
│ • 중기: HDD (최근 수 일)                       │
│ • 장기: 테이프/클라우드 (수 개월)               │
└─────────────────────────────────────────────────┘

4. 압축 및 중복 제거:
┌─────────────────────────────────────────────────┐
│ • 실시간 압축 (LZ4, Snappy)                    │
│ • 중복 패킷 제거                                │
│ • 델타 압축                                     │
│ • 패턴 기반 압축                                │
└─────────────────────────────────────────────────┘

고성능 패킷 처리 기술:
┌─────────────────────────────────────────────────┐
│ DPDK (Data Plane Development Kit):              │
│ • 커널 바이패스                                    │ 
│ • 유저 모드 드라이                                  |
│ DPDK (Data Plane Development Kit):              │
│ • 커널 바이패스                                    │
│ • 유저 모드 드라이버                                │
│ • 제로 카피 처리                                   │
│ • 폴링 모드 드라이버                                │
│                                                 │
│ XDP (eXpress Data Path):                       │
│ • 커널 레벨 패킷 처리                              │
│ • eBPF 기반 프로그래밍                             │
│ • 드라이버 레벨에서 패킷 처리                         │
│                                                 │
│ SR-IOV (Single Root I/O Virtualization):       │
│ • 하드웨어 레벨 가상화                              │
│ • 직접 하드웨어 접근                                │
│ • VM에서 네이티브 성능                              │
└─────────────────────────────────────────────────┘
```

## 실제 NIDS 구현 사례

```
상용 NIDS 솔루션:

Snort (오픈소스):
┌─────────────────────────────────────────────────┐
│ 특징:                                           │
│ • 룰 기반 탐지                                  │
│ • 실시간 트래픽 분석                            │
│ • 커뮤니티 룰셋 제공                            │
│                                                 │
│ 성능:                                           │
│ • 일반 서버: 100Mbps-1Gbps                     │
│ • 최적화 시: 2-5Gbps                           │
│                                                 │
│ 룰 예시:                                        │
│ alert tcp any any -> any 80 (                  │
│   msg:"Possible SQL injection";                │
│   content:"union select";                      │
│   sid:1000001;                                 │
│ )                                               │
└─────────────────────────────────────────────────┘

Suricata (차세대 오픈소스):
┌─────────────────────────────────────────────────┐
│ 특징:                                           │
│ • 멀티스레드 아키텍처                           │
│ • GPU 가속 지원                                │
│ • JSON 로그 출력                               │
│ • 하드웨어 오프로드 지원                        │
│                                                 │
│ 성능:                                           │
│ • 멀티코어 최적화                               │
│ • 10Gbps+ 처리 가능                            │
│ • 메모리 효율적 처리                            │
└─────────────────────────────────────────────────┘

상용 솔루션 (Palo Alto, Fortinet):
┌─────────────────────────────────────────────────┐
│ 하드웨어 특화:                                  │
│ • 전용 ASIC 칩                                 │
│ • 40Gbps-100Gbps 처리                         │
│ • 하드웨어 암호화 지원                          │
│                                                 │
│ 통합 기능:                                      │
│ • IPS + 방화벽 + DLP                           │
│ • 위협 인텔리전스 연동                          │
│ • 머신러닝 기반 탐지                            │
└─────────────────────────────────────────────────┘
```

## 메모리 기반 실시간 분석

```
인메모리 분석 아키텍처:

링 버퍼 (Ring Buffer):
┌─────────────────────────────────────────────────┐
│ 순환형 메모리 구조:                             │
│                                                 │
│ ┌─[패킷1]─[패킷2]─[패킷3]─[패킷4]─┐            │
│ │                               │            │
│ └─[패킷8]─[패킷7]─[패킷6]─[패킷5]─┘            │
│                                                 │
│ 특징:                                           │
│ • 고정 크기 메모리 사용                         │
│ • 오래된 데이터 자동 덮어쓰기                   │
│ • 락 프리 구조로 고성능                         │
└─────────────────────────────────────────────────┘

스트리밍 분석 파이프라인:
┌─────────────────────────────────────────────────┐
│ 패킷 수신 → 파싱 → 분석 → 액션 → 로깅           │
│     ↓         ↓      ↓      ↓      ↓           │
│   NIC    L2-L7   룰엔진  알림   압축저장        │
│                                                 │
│ 각 단계별 최적화:                               │
│ • 병렬 처리                                     │
│ • 파이프라인 구조                               │
│ • 배치 처리                                     │
│ • 비동기 I/O                                   │
└─────────────────────────────────────────────────┘

메모리 관리 전략:
┌─────────────────────────────────────────────────┐
│ 계층적 캐시:                                    │
│ • L1 캐시: 현재 분석 중 패킷                    │
│ • L2 캐시: 최근 세션 정보                       │
│ • L3 캐시: 통계 및 메타데이터                   │
│                                                 │
│ 메모리 풀:                                      │
│ • 사전 할당된 메모리 블록                       │
│ • 가비지 컬렉션 최소화                          │
│ • NUMA 인식 할당                               │
└─────────────────────────────────────────────────┘
```

## 분산 분석 시스템

```
확장 가능한 Out of Path 아키텍처:

로드 밸런싱:
┌─────────────────────────────────────────────────┐
│ 네트워크 TAP                                    │
│         │                                       │
│    ┌────┴────┐                                  │
│    │로드밸런서│                                  │
│    └─┬─┬─┬─┬─┘                                  │
│      │ │ │ │                                    │
│   분석서버들                                     │
│                                                 │
│ 분산 방식:                                      │
│ • 해시 기반 (IP 주소)                          │
│ • 라운드 로빈                                   │
│ • 트래픽 타입별                                 │
└─────────────────────────────────────────────────┘

실시간 데이터 파이프라인:
┌─────────────────────────────────────────────────┐
│ Apache Kafka 기반:                              │
│                                                 │
│ 패킷수집 → Kafka → Stream처리 → 저장/알림        │
│                      │                         │
│                 Spark/Flink                    │
│                 Storm/Samza                    │
│                                                 │
│ 장점:                                           │
│ • 수평 확장 가능                                │
│ • 장애 허용성                                   │
│ • 백프레셔 처리                                 │
└─────────────────────────────────────────────────┘

클라우드 네이티브 접근:
┌─────────────────────────────────────────────────┐
│ 컨테이너 기반 분석:                             │
│ • Docker/Kubernetes                            │
│ • 마이크로서비스 아키텍처                       │
│ • 자동 스케일링                                 │
│                                                 │
│ 서버리스 분석:                                  │
│ • AWS Lambda/Azure Functions                   │
│ • 이벤트 기반 처리                              │
│ • 비용 최적화                                   │
└─────────────────────────────────────────────────┘
```

## 머신러닝 기반 이상 탐지

```
AI/ML 적용 Out of Path 분석:

행동 기반 분석:
┌─────────────────────────────────────────────────┐
│ 정상 트래픽 패턴 학습:                          │
│ • 시간대별 트래픽 볼륨                          │
│ • 프로토콜 분포                                 │
│ • 지리적 패턴                                   │
│ • 사용자 행동 패턴                              │
│                                                 │
│ 이상 탐지:                                      │
│ • 통계적 이상치 탐지                            │
│ • 딥러닝 기반 패턴 분석                         │
│ • 클러스터링 기반 분류                          │
└─────────────────────────────────────────────────┘

실시간 ML 추론:
┌─────────────────────────────────────────────────┐
│ 경량화된 모델:                                  │
│ • 모델 압축 및 양자화                           │
│ • 엣지 최적화                                   │
│ • 실시간 추론 (<1ms)                           │
│                                                 │
│ 하이브리드 접근:                                │
│ • 룰 기반 + ML 기반                            │
│ • 빠른 필터링 + 정밀 분석                       │
│ • 온라인 학습 + 배치 학습                       │
└─────────────────────────────────────────────────┘
```

이러한 **Out of Path 구조와 DPI 기술**을 이해하면 **네트워크 보안 모니터링, 성능 분석, 컴플라이언스 관리**에서 **효과적인 시스템 설계와 운영 전략**을 수립할 수 있습니다. 특히 **실시간 대용량 데이터 처리**라는 기술적 도전을 해결하는 것이 핵심입니다.