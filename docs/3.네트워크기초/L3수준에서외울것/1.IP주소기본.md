### IPv4 주소의 구조

### L3 계층의 핵심 식별자

```
계층별 식별자 비교:

L2 (Data Link Layer):
├─ 식별자: MAC 주소
├─ 비트 수: 48비트 (6바이트)
├─ 표현: xx:xx:xx:xx:xx:xx
├─ 범위: 물리적 네트워크 세그먼트 내
└─ 특성: 하드웨어에 고정, 변경 불가

L3 (Network Layer):
├─ 식별자: IP 주소 (IPv4)
├─ 비트 수: 32비트 (4바이트)  
├─ 표현: xxx.xxx.xxx.xxx
├─ 범위: 전 세계 인터넷
└─ 특성: 소프트웨어로 설정, 변경 가능
```

**L2에서의 식별자는 MAC 주소 48비트 주소 체계를 가집니다. 그러면 L3 네트워크 계층에서의 가장 중요한 식별자는 IP이고 IPv4 기준 32비트 주소 체계를 가집니다.**

### IPv4 주소의 수치적 구조

**8bit × 4로 표현할 수 있는 숫자의 가지 수는 0 ~ 255까지입니다.**

```
IPv4 32비트 구조 분석:

전체 주소 공간:
32비트 = 2³² = 4,294,967,296개 (약 43억 개)

8비트 단위 분할:
┌─────────┬─────────┬─────────┬─────────┐
│ 8비트   │ 8비트   │ 8비트   │ 8비트   │
│ 0~255   │ 0~255   │ 0~255   │ 0~255   │
└─────────┴─────────┴─────────┴─────────┘

각 옥텟(Octet)의 범위:
├─ 최소값: 0 (0000 0000)
├─ 최대값: 255 (1111 1111)
├─ 총 가지수: 256개 (0 포함)
└─ 유효 범위: 실제로는 예약 주소 제외
```

### IP 주소의 구조적 분할

**그래서 IP 구조는 이렇게 생겼습니다.**

### Network ID와 Host ID의 구분

```
IPv4 주소 구조 예시:

192      .168       .0          .10
│                               │
├─── Network ID (24비트) ────┤  Host ID (8비트)
│                               │
1100 0000.1010 1000.0000 0000 | 0000 1010
         Network 부분           |  Host 부분
```

**.을 기준으로 사용할 수 있는 숫자의 범위는 8비트입니다. 8개의 비트 단위로 dot(.)을 찍어서 구분해서 표현합니다. 이 IP 주소는 앞의 24비트와 뒤의 8비트를 나눠서 24비트인 Network ID와 Host(네트워크에 연결된 컴퓨터) ID로 구분합니다.**

### 서브넷 마스크와 주소 분할

```
서브넷 마스크를 통한 구분:

IP 주소:    192.168.0.10
서브넷 마스크: 255.255.255.0 (/24)

이진수 표현:
IP:     11000000.10101000.00000000.00001010
Mask:   11111111.11111111.11111111.00000000
        └──────── Network ─────────┘└Host┘

AND 연산 결과:
Network: 11000000.10101000.00000000.00000000
        = 192.168.0.0 (네트워크 주소)

Host:   00001010 = 10 (호스트 번호)
```

### IP 주소의 식별 기능

**IP 주소라고 하는 것은 호스트에 대한 식별자, 인터넷 프로토콜을 쓰는 인터넷에 연결된 컴퓨터 한 대를 식별하기 위해서 부여하는 고유 번호입니다.**

### 계층적 주소 체계의 필요성

**그래서 Network ID는 서울시 강남구 역삼동~이고 Host ID는 이제 번지 정도가 됩니다.**

```
IP 주소의 계층적 구조 비유:

물리적 주소          │ IP 주소
────────────────────┼─────────────────
서울특별시          │ 대한민국 (국가)
강남구              │ SKT, KT (ISP)  
역삼동              │ 192.168.0.x (Network ID)
123번지             │ .10 (Host ID)

계층별 라우팅:
국제 → ISP 선택
ISP → 네트워크 선택  
네트워크 → 호스트 선택
```

### 라우팅 효율성을 위한 설계

**근데 왜 이렇게 구분해서 구성되었냐 하면 결국 이 IP라는 것은 이 주소를 목적지로써 식별해서 도착해야 하기 때문입니다.**

### 택배 시스템과의 비교

**그래서 우리가 택배를 보내면 택배들이 특정 구역 단위를 관리하는 분류 센터에 모두 도착해서 거기서 다시 택배를 취합 후 목적지까지 배송하게 되는데 그래서 먼저 이 분류센터까지 가는데 필요한 주소가 Network ID이고 이를 기반으로 정확한 주소까지 도착하는데 사용되는 게 Host ID입니다.**

```
택배 배송 시스템 vs IP 라우팅:

택배 배송 과정:
발송지 → 출발 분류센터 → 간선 운송 → 도착 분류센터 → 최종 배송

IP 라우팅 과정:
출발 호스트 → 로컬 라우터 → 인터넷 백본 → 목적지 라우터 → 목적지 호스트

단계별 주소 활용:

1단계: 네트워크 찾기 (분류센터 찾기)
┌─────────────────────────────────────────┐
│ 목적지: 192.168.1.10                    │
│ 라우터: "192.168.1.0 네트워크로 가야겠다"│
│ = "강남구 택배센터로 보내야겠다"         │
└─────────────────────────────────────────┘

2단계: 호스트 찾기 (정확한 번지 찾기)  
┌─────────────────────────────────────────┐
│ 네트워크 도착 후: "10번 호스트 찾기"     │
│ = "123번지 정확한 주소 찾기"            │
└─────────────────────────────────────────┘
```

### 라우팅 테이블에서의 주소 활용

### Network ID 기반 라우팅

```
라우팅 테이블 예시:

목적지 네트워크     │ 게이트웨이    │ 인터페이스
─────────────────────┼───────────────┼─────────────
192.168.1.0/24     │ 직접연결      │ eth0
10.0.0.0/8         │ 10.0.0.1      │ eth1  
172.16.0.0/12      │ 172.16.0.1    │ eth2
0.0.0.0/0          │ 203.0.113.1   │ eth3

라우터 동작:
1. 패킷 수신: 목적지 192.168.1.100
2. Network ID 추출: 192.168.1.0/24  
3. 라우팅 테이블 검색: 직접연결 확인
4. eth0 인터페이스로 전달
5. 최종 스위치에서 Host ID(.100) 기반 전달
```

### 주소 체계의 확장성

```
다양한 네트워크 크기 지원:

Class A (대규모):
├─ Network: 8비트 (126개 네트워크)
├─ Host: 24비트 (16,777,214개 호스트)
└─ 예시: 10.0.0.0/8

Class B (중규모):  
├─ Network: 16비트 (16,384개 네트워크)
├─ Host: 16비트 (65,534개 호스트)
└─ 예시: 172.16.0.0/16

Class C (소규모):
├─ Network: 24비트 (2,097,152개 네트워크)  
├─ Host: 8비트 (254개 호스트)
└─ 예시: 192.168.1.0/24

CIDR (현대적 방식):
├─ 가변 길이 서브넷 마스크
├─ 효율적 주소 할당
└─ 예시: 192.168.1.0/25 (128개 호스트)
```

### 실제 네트워크에서의 주소 운용

### 네트워크 설계 예시

```
회사 네트워크 설계:

전체 네트워크: 192.168.0.0/16

부서별 서브넷 분할:
├─ 경영진: 192.168.1.0/24 (254개 호스트)
├─ 개발팀: 192.168.2.0/24 (254개 호스트)  
├─ 마케팅: 192.168.3.0/24 (254개 호스트)
├─ 서버존: 192.168.100.0/24 (254개 서버)
└─ 게스트: 192.168.200.0/24 (254개 임시)

라우팅 효율성:
- 라우터는 부서별 네트워크만 인식
- 각 부서 내 호스트는 스위치에서 처리
- 계층적 구조로 관리 복잡도 감소
```

### 주소 고갈 문제와 해결책

```
IPv4 주소 고갈 현실:

전체 주소: 43억 개 (2³²)
실제 사용 가능: 약 37억 개 (예약 주소 제외)

해결 방안:
1. NAT (Network Address Translation):
   사설 IP → 공인 IP 변환으로 주소 재사용

2. CIDR (Classless Inter-Domain Routing):
   효율적 주소 할당으로 낭비 최소화

3. IPv6 도입:
   128비트로 확장 (2¹²⁸ ≈ 340조의 조배)

현재 상황:
- IPv4: 여전히 주력 사용
- IPv6: 점진적 도입 중
- 듀얼 스택: 두 프로토콜 병행 운영
```

이처럼 **IPv4의 Network ID/Host ID 분할은 단순한 주소 체계가 아니라, 전 세계 인터넷의 확장성과 효율성을 보장하는 핵심 설계 원칙**입니다. **택배 시스템처럼 계층적 배송을 통해 복잡한 네트워크에서도 효율적인 라우팅**을 가능하게 하는 것이죠!