## SSL 기초이론 - 해시 함수(Hash Function)

**해시 함수의 핵심 특징**

해시 함수는 앞서 체크섬에서 발전한 형태로, 보안성을 크게 강화한 데이터 무결성 검증 기술입니다.

**1. 단방향성 (One-way Property)**

**예를 들어 7%5를 해서 나머지가 2가 나오는 함수가 있다고 가정해보자. 이때 결과값인 2를 가지고 7을 추론하기는 매우 어렵다. 그 이유는 어떤 값을 5로 나눴을 때 2가 나오는 숫자가 너무 많기 때문이다. 이 경우 7에 대한 값이 유실되었다고 한다.**

```
🔢 모듈로 연산을 통한 단방향성 이해

정방향 (쉬움):
7 % 5 = 2 ✓

역방향 (매우 어려움):
2 ← ? % 5

가능한 원본값들:
2, 7, 12, 17, 22, 27, 32, 37, 42, 47...
무한히 많은 경우의 수 → 원본 특정 불가능!

이것이 바로 "값의 유실"
```

**2. 고정 길이 출력 (Fixed Output Length)**

**5를 나누어서 나머지를 구했다고 한다면 값이 나누어떨어져서 0이거나 혹은 1~~4의 값을 가지거나, 나올 수 있는 경우의 수는 5가지로 제한된다. 값은 5보다 작은 0에서 4까지로 제한된다. 그래서 값의 크기가 0~~4로 특정되어진다.**

```
📏 고정 길이 출력의 특성

모듈로 5 연산의 경우:
입력값의 크기와 무관하게 출력 범위 고정

┌─────────────────┐
│입력: 7          │ → 7%5 = 2
│입력: 12345      │ → 12345%5 = 0  
│입력: 999999     │ → 999999%5 = 4
│입력: 1000000000 │ → 1000000000%5 = 0
└─────────────────┘
           ↓
    출력 범위: 0~4 (항상 5가지 경우)

실제 해시 함수도 동일한 원리:
- MD5: 항상 128bit (32글자 16진수)
- SHA-256: 항상 256bit (64글자 16진수)
```

**그래서 나머지 연산을 수행하는 경우 나누어 주는 숫자 범위로 제한하는 특징이 있습니다.**

**3. 데이터 무결성 확보**

**그래서 이 Hash 함수를 어디다 사용하느냐 하면 바로 이 해시 함수를 데이터 무결성을 확보하는 데 사용한다. 데이터 무결성이란 이 데이터가 절대 변조 혹은 위조가 되지 않았다는 것을 증명하는 것이다. 그래서 실제로 이 Checksum이 할 일을 Hash로 대체하는 경우도 빈번하다.**

```
🛡️ 체크섬 vs 해시 함수 비교

체크섬의 한계:
┌─────────────────────────────────┐
│원본: "PAY $100"                │
│체크섬: 45                      │
│                                │
│공격자가 조작:                  │
│변조: "PAY $999"                │
│새 체크섬: 78 (재계산 가능)     │
│결과: 변조 탐지 실패 ❌        │
└─────────────────────────────────┘

해시 함수의 강화:
┌─────────────────────────────────┐
│원본: "PAY $100"                │
│해시: "a5f2d..."                │
│                                │
│공격자가 조작 시도:              │
│변조: "PAY $999"                │
│새 해시: "b7e4c..." (전혀 다름) │
│결과: 변조 즉시 탐지 ✅        │
└─────────────────────────────────┘
```

**해시 함수의 고급 특성**

**기본적으로 Hash를 하는 방법은 어떤 수를 나눠서 나머지를 구해라. 그러면 해당 나머지 값으로 원래 숫자를 구하려면 이 몫을 버렸기 때문에 원래 숫자를 못 찾아낸다. 근데 이렇게 단순하게 처리하지는 않는다.**

**이 경우의 수라는 범위가 굉장히 넓어야 하고 겹치는 숫자가 존재하면 안 된다. 이러한 것이 좋은 해시 알고리즘이다. 즉, 이 원본이 달라지면 이 결과값도 항상 다른 값이 나와야 한다.**

```
⚙️ 좋은 해시 알고리즘의 조건

1️⃣ 충돌 저항성 (Collision Resistance)
서로 다른 입력 → 서로 다른 출력

┌─────────────────┐
│"password123"    │ → 해시값 A
│"admin456"       │ → 해시값 B  
│"user789"        │ → 해시값 C
└─────────────────┘
A ≠ B ≠ C (모두 달라야 함)

2️⃣ 넓은 출력 공간
MD5: 2^128 = 340,282,366,920,938,463,463,374,607,431,768,211,456가지
SHA-256: 2^256 = 더욱 광대한 경우의 수

3️⃣ 눈사태 효과 (Avalanche Effect)  
입력의 1비트 변화 → 출력의 50% 이상 변화
"password" vs "passwore" → 완전히 다른 해시값
```

**주요 해시 알고리즘**

**대표적으로 Hash 알고리즘은 크게 MD 계열과 SHA 계열이 있다.**

```
📚 해시 알고리즘 발전사

MD 계열:
┌─────────────────────────────────┐
│MD-5                            │
│• 128비트 출력                  │
│• ❌ 패스워드 단방향 암호화 사용금지│
│• 충돌 공격 취약점 발견         │
│• 현재 보안용도 사용 중단       │
└─────────────────────────────────┘

SHA 계열:
┌─────────────────────────────────┐
│SHA-1                           │
│• 160비트 출력                  │
│• ❌ 2017년 구글 충돌 공격 성공 │
│                               │
│SHA-2 계열 (현재 표준):         │
│• SHA-224: 224비트              │
│• SHA-256: 256비트 ← 널리 사용  │
│• SHA-384: 384비트              │
│• SHA-512: 512비트              │
│                               │
│SHA-3 (Keccak):                │
│• 2015년 NIST 표준             │
│• 미래 대비 알고리즘           │
└─────────────────────────────────┘
```

**알고리즘 뒤에 숫자가 크면 클수록 좀 더 좋은 것이라고 보면 된다. 숫자가 크다는 말은 이 경우의 수에 대한 범위가 넓다는 이야기다. 즉, 충돌 가능성이 적고 보안성이 뛰어나다.**

**해시 함수 동작 예시**

**MD-5 해시 결과**

`"TestString" --> Hash(x) = y --> MrRq3uWeS1#N#aKHtSqb#m`

**지금 원본 글자 TestString이라는 글자가 짧은데 해시 결과값에 글자 길이가 더 늘어났다. MD-5든 뭐든 어떤 해시를 하게 되면 길이가 항상 일정하다. 원본 길이에 상관없이 항상 일정된 길이로 결과값이 떨어진다. 위에 해시 결과로 TestString이라는 값을 추론하기가 어렵기 때문에 단방향이다라고 말하는 것이다.**

```
🔍 해시 함수 동작 실례

다양한 입력 길이:
┌─────────────────────────────────┐
│입력: "A"                       │
│MD5:  "7fc56270e7a70fa81a5935b72eacbe29" │
│                                │  
│입력: "TestString"               │
│MD5:  "MrRq3uWeS1#N#aKHtSqb#m"   │
│                                │
│입력: "매우 긴 문자열입니다..."   │
│MD5:  "a1b2c3d4e5f6..."         │
└─────────────────────────────────┘

특징:
✅ 입력 길이: 1글자 ~ 수천글자
✅ 출력 길이: 항상 32글자 (128비트)
✅ 역추적: 해시값만으로 원본 추론 불가
```