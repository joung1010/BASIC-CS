## 암호화 기술에 대한 이해 - 디지털 서명

### 디지털 서명의 개념과 필요성

**서명이란 우리가 어떤 계약서에 날인함으로써 이 계약 내용이 유효하다라는 걸 약속함을 나타내는 것이다. 근데 이 서명이나 도장을 나 대신 위조해서 대신 한다면 그것은 사기이다. 그래서 내가 계약했는데 안 했다고 하는 부인 방지와 위변조 방지 이런 것들이 필요하다. 그러면 인터넷 환경에서 요구되는 디지털 서명이 있다.**

```
물리적 서명 vs 디지털 서명 비교

물리적 서명:
┌─────────────────────────────────┐
│📝 계약서                       │
│                                │
│당사자: 홍길동                  │
│조건: ...                      │
│                                │
│서명: [홍길동] 📋 (도장/사인)   │
│날짜: 2024.12.17                │
└─────────────────────────────────┘

문제점:
❌ 위조 가능성 (필적, 도장 복제)
❌ 부인 가능성 ("내가 서명 안 했다")
❌ 변조 탐지 어려움 (내용 수정)

디지털 서명:
┌─────────────────────────────────┐
│💻 전자 문서                    │
│                                │
│당사자: 홍길동                  │
│조건: ...                      │
│                                │
│디지털 서명: [암호화된 해시값]   │
│타임스탬프: 2024.12.17 14:30:25 │
└─────────────────────────────────┘

해결책:
✅ 위조 불가능 (개인키 필요)
✅ 부인 방지 (암호학적 증명)
✅ 변조 즉시 탐지 (해시값 변경)
```

### 디지털 서명의 구조

**우리가 흔히 말하는 인증서는 그 내부에 Public Key가 존재하고 Public Key가 존재한다는 것은 이와 쌍을 이루는 Private Key 또한 존재한다는 말이다. 그래서 이 Private Key를 가지고 디지털 서명을 한다.**

```
디지털 인증서 구조

┌─────────────────────────────────┐
│     디지털 인증서 (X.509)       │
├─────────────────────────────────┤
│• 버전 정보                     │
│• 일련번호                      │
│• 서명 알고리즘                 │
│• 발급기관 (CA)                 │
│• 유효기간 (시작~종료)          │
│• 주체 정보 (소유자)            │
│• 🔓 공개키 ← 여기에 포함       │
│• 확장 필드                     │
│• CA의 디지털 서명              │
└─────────────────────────────────┘
           ⬇
    키 쌍 관계 (수학적 연결)
           ⬇
┌─────────────────────────────────┐
│🔒 개인키 (Private Key)         │
│• 절대 공개 안 됨               │
│• 소유자만 보관                 │
│• 디지털 서명 생성용            │
└─────────────────────────────────┘
```

### 디지털 서명 과정의 정확한 이해

메모에서 "**Private Key로 암호화를 한다**"고 설명했는데, 이는 개념적으로 이해하기 쉽게 표현한 것이지만 기술적으로는 부정확합니다. 정확한 과정을 설명하면:

```
디지털 서명의 정확한 과정

잘못된 이해:
문서 → Private Key로 "암호화" → 서명

올바른 과정:
┌─────────────────────────────────┐
│1단계: 문서 해시 계산            │
│원본 문서 → 해시 함수 → 해시값  │
│                                │
│2단계: 해시값에 서명 생성        │
│해시값 → Private Key → 디지털 서명│
│(수학적 변환, 암호화가 아님)     │
│                                │
│3단계: 문서 + 서명 전송          │
│원본 문서 + 디지털 서명 → 수신자│
└─────────────────────────────────┘

서명 검증 과정:
┌─────────────────────────────────┐
│1단계: 받은 문서 해시 재계산     │
│수신된 문서 → 해시 함수 → 해시값A│
│                                │
│2단계: 서명에서 해시값 추출      │
│디지털 서명 → Public Key → 해시값B│
│                                │
│3단계: 해시값 비교               │
│해시값A == 해시값B → 검증 성공   │
└─────────────────────────────────┘
```

### 실제 디지털 서명 동작 원리

메모의 예시를 정확히 보완하면:

```
문서 디지털 서명 실제 과정

원본 문서:
┌─────────────────────────────────┐
│계약서 내용                     │
│~~~                             │
│당사자: A회사, B회사            │
│~~~                             │
│금액: 1억원                     │
│~~                              │
└─────────────────────────────────┘
           ⬇ 해시 계산
┌─────────────────────────────────┐
│해시값: MrRq3uWeS1#N#aKHtSqb#m   │
└─────────────────────────────────┘
           ⬇ Private Key로 서명 생성
┌─────────────────────────────────┐
│디지털 서명: X7Y8Z9A1B2C3D4E5... │
└─────────────────────────────────┘

전송 패킷:
┌─────────────────────────────────┐
│• 원본 문서                     │
│• 디지털 서명                   │
│• 송신자 인증서 (공개키 포함)   │
└─────────────────────────────────┘
```

### 디지털 서명이 제공하는 보안 속성

```
디지털 서명의 4가지 핵심 기능

1️⃣ 인증 (Authentication)
┌─────────────────────────────────┐
│"이 문서는 정말 홍길동이 작성했나?"│
│                                │
│검증: 홍길동의 개인키로만 생성   │
│가능한 서명 → 홍길동 확인       │
└─────────────────────────────────┘

2️⃣ 무결성 (Integrity)
┌─────────────────────────────────┐
│"문서 내용이 변조되지 않았나?"   │
│                                │
│검증: 해시값 비교로 변조 탐지   │
│1비트만 변경되어도 완전히 다른  │
│해시값 생성                     │
└─────────────────────────────────┘

3️⃣ 부인방지 (Non-repudiation)
┌─────────────────────────────────┐
│"나는 그런 계약서에 서명 안 했어"│
│                                │
│반박: 당신의 개인키로만 생성    │
│가능한 서명 → 부인 불가능       │
└─────────────────────────────────┘

4️⃣ 시점 증명 (Timestamp)
┌─────────────────────────────────┐
│"언제 서명했는지 증명 필요"     │
│                                │
│해결: 타임스탬프 서버 활용      │
│정확한 서명 시점 기록           │
└─────────────────────────────────┘
```

### 위변조 탐지 메커니즘

**예를 들어 문서가 있으면 문서에 있는 내용을 누군가 위조나 변조하지 못하게 원본 문서의 해시를 계산하고 Public Key로 풀어서 비교한다.**

```
변조 탐지 시나리오

정상적인 경우:
┌─────────────────────────────────┐
│원본 문서 → 해시A → 서명 생성    │
│전송된 문서 → 해시B → 서명 검증  │
│해시A == 해시B → 검증 성공       │
└─────────────────────────────────┘

변조된 경우:
┌─────────────────────────────────┐
│원본: "금액 100만원"             │
│해시A: abc123...                │
│      ⬇                         │
│변조: "금액 1000만원"           │
│해시B: def456... (완전히 다름)  │
│      ⬇                         │
│해시A ≠ 해시B → 검증 실패       │
│변조 즉시 탐지!                 │
└─────────────────────────────────┘
```

### PKI 생태계에서의 디지털 서명

```
실제 디지털 서명 인프라

인증서 발급 과정:
┌─────────────────────────────────┐
│1. 사용자가 키 쌍 생성           │
│   (공개키 + 개인키)            │
│                               │
│2. 공개키 + 신원정보를 CA에 제출│
│                               │
│3. CA가 신원 확인 후 인증서 발급│
│   (CA의 개인키로 서명)         │
│                               │
│4. 발급된 인증서 배포/사용      │
└─────────────────────────────────┘

신뢰 체인 (Chain of Trust):
┌─────────────────────────────────┐
│루트 CA (Root Certificate)      │
│        ⬇ 서명                  │
│중간 CA (Intermediate CA)       │
│        ⬇ 서명                  │
│최종 사용자 인증서               │
│                               │
│브라우저/OS에 루트 CA 내장      │
│→ 전체 체인 자동 검증           │
└─────────────────────────────────┘
```

디지털 서명은 **물리적 서명을 디지털 세상에서 구현한 혁신적 기술**로, **해시 함수와 비대칭키 암호화**를 결합하여 **인증, 무결성, 부인방지**를 동시에 제공합니다. 특히 **SSL/TLS, 전자상거래, 블록체인** 등 현대 디지털 인프라의 핵심 보안 메커니즘으로 활용되고 있습니다.